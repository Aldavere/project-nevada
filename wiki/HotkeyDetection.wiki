= COxUtilHotkey =

== Script: ==

{{{
scn COxUtilHotkeyScript

; Stage 1
;	In:
;		keyCode			Scancode of the key that was pressed as returned by getKeyPress.
;
;	Out:
;		confirmMsg		Message box reference, saying "Selected key: X".
;		warningMsg		Message box reference, saying "The key you selected is already assigned to 'X'." in case there was a conflict, otherwise 0.
;		conflict			Set to 1 if a conflict was detected, otherwise 0.

; In
short keyCode

; Out
ref confirmMsg
ref warningMsg
short conflict

}}}

== Stage 1 ==

{{{
; Local vars
short keyCode
short i
short n
ref func

; Fetch & clear input
set keyCode to COxUtilHotkey.keyCode
set COxUtilHotkey.keyCode to 0

; Clear output
set COxUtilHotkey.confirmMsg to 0
set COxUtilHotkey.warningMsg to 0
set COxUtilHotkey.conflict to 0

;----------------------------------------------------------------------------------------------------
; Confirmation selection

if keyCode == 1
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey001Msg
	return
elseif keyCode == 2
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey002Msg
	return
elseif keyCode == 3
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey003Msg
	return
elseif keyCode == 4
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey004Msg
	return
elseif keyCode == 5
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey005Msg
	return
elseif keyCode == 6
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey006Msg
	return
elseif keyCode == 7
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey007Msg
	return
elseif keyCode == 8
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey008Msg
	return
elseif keyCode == 9
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey009Msg
	return
elseif keyCode == 10
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey010Msg
	return
	
elseif keyCode == 11
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey011Msg
	return
elseif keyCode == 12
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey012Msg
	return
elseif keyCode == 13
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey013Msg
	return
elseif keyCode == 14
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey014Msg
	return
elseif keyCode == 15
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey015Msg
	return
elseif keyCode == 16
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey016Msg
	return
elseif keyCode == 17
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey017Msg
	return
elseif keyCode == 18
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey018Msg
	return
elseif keyCode == 19
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey019Msg
	return
elseif keyCode == 20
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey020Msg
	return
	
elseif keyCode == 21
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey021Msg
	return
elseif keyCode == 22
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey022Msg
	return
elseif keyCode == 23
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey023Msg
	return
elseif keyCode == 24
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey024Msg
	return
elseif keyCode == 25
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey025Msg
	return
elseif keyCode == 26
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey026Msg
	return
elseif keyCode == 27
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey027Msg
	return
elseif keyCode == 28
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey028Msg
	return
elseif keyCode == 29
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey029Msg
	return
elseif keyCode == 30
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey030Msg
	return
	
elseif keyCode == 31
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey031Msg
	return
elseif keyCode == 32
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey032Msg
	return
elseif keyCode == 33
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey033Msg
	return
elseif keyCode == 34
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey034Msg
	return
elseif keyCode == 35
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey035Msg
	return
elseif keyCode == 36
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey036Msg
	return
elseif keyCode == 37
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey037Msg
	return
elseif keyCode == 38
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey038Msg
	return
elseif keyCode == 39
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey039Msg
	return
elseif keyCode == 40
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey040Msg
	return

elseif keyCode == 41
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey041Msg
	return
elseif keyCode == 42
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey042Msg
	return
elseif keyCode == 43
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey043Msg
	return
elseif keyCode == 44
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey044Msg
	return
elseif keyCode == 45
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey045Msg
	return
elseif keyCode == 46
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey046Msg
	return
elseif keyCode == 47
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey047Msg
	return
elseif keyCode == 48
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey048Msg
	return
elseif keyCode == 49
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey049Msg
	return
elseif keyCode == 50
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey050Msg
	return
	
elseif keyCode == 51
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey051Msg
	return
elseif keyCode == 52
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey052Msg
	return
elseif keyCode == 53
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey053Msg
	return
elseif keyCode == 54
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey054Msg
	return
elseif keyCode == 55
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey055Msg
	return
elseif keyCode == 56
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey056Msg
	return
elseif keyCode == 57
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey057Msg
	return
elseif keyCode == 58
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey058Msg
	return
elseif keyCode == 59
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey059Msg
	return
elseif keyCode == 60
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey060Msg
	return
	
elseif keyCode == 61
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey061Msg
	return
elseif keyCode == 62
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey062Msg
	return
elseif keyCode == 63
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey063Msg
	return
elseif keyCode == 64
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey064Msg
	return
elseif keyCode == 65
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey065Msg
	return
elseif keyCode == 66
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey066Msg
	return
elseif keyCode == 67
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey067Msg
	return
elseif keyCode == 68
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey068Msg
	return
elseif keyCode == 69
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey069Msg
	return
elseif keyCode == 70
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey070Msg
	return
	
elseif keyCode == 71
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey071Msg
	return
elseif keyCode == 72
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey072Msg
	return
elseif keyCode == 73
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey073Msg
	return
elseif keyCode == 74
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey074Msg
	return
elseif keyCode == 75
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey075Msg
	return
elseif keyCode == 76
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey076Msg
	return
elseif keyCode == 77
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey077Msg
	return
elseif keyCode == 78
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey078Msg
	return
elseif keyCode == 79
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey079Msg
	return
elseif keyCode == 80
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey080Msg
	return
	
elseif keyCode == 81
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey081Msg
	return
elseif keyCode == 82
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey082Msg
	return
elseif keyCode == 83
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey083Msg
	return
elseif keyCode == 87
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey087Msg
	return
elseif keyCode == 88
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey088Msg
	return
	
elseif keyCode == 156
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey156Msg
	return
elseif keyCode == 157
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey157Msg
	return
elseif keyCode == 181
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey181Msg
	return
elseif keyCode == 184
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey184Msg
	return
elseif keyCode == 200
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey200Msg
	return
elseif keyCode == 203
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey203Msg
	return
elseif keyCode == 205
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey205Msg
	return
elseif keyCode == 208
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey208Msg
	return
elseif keyCode == 256
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey256Msg
	return
elseif keyCode == 257
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey257Msg
	return
elseif keyCode == 258
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey258Msg
	return
elseif keyCode == 259
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey259Msg
	return
elseif keyCode == 260
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey260Msg
	return
elseif keyCode == 261
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey261Msg
	return
elseif keyCode == 262
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey262Msg
	return
elseif keyCode == 263
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey263Msg
	return
elseif keyCode == 264
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey264Msg
	return
elseif keyCode == 265
	set COxUtilHotkey.confirmMsg to COxShowSelectedKey265Msg
	return
endif

;----------------------------------------------------------------------------------------------------
; Conflict detection

; Default controls
if keyCode == getControl 0
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey0Msg
	return
elseif keyCode == getControl 1
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey1Msg
	return
elseif keyCode == getControl 2
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey2Msg
	return
elseif keyCode == getControl 3
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey3Msg
	return
elseif keyCode == getControl 4
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey4Msg
	return
elseif keyCode == getControl 5
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey5Msg
	return
elseif keyCode == getControl 6
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey6Msg
	return
elseif keyCode == getControl 7
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey7Msg
	return
elseif keyCode == getControl 8
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey8Msg
	return
elseif keyCode == getControl 9
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey9Msg
	return
elseif keyCode == getControl 10
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey10Msg
	return
elseif keyCode == getControl 11
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey11Msg
	return
elseif keyCode == getControl 12
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey12Msg
	return
elseif keyCode == getControl 13
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey13Msg
	return
elseif keyCode == getControl 14
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey14Msg
	return
elseif keyCode == getControl 15
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey15Msg
	return
elseif keyCode == getControl 16
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey16Msg
	return
elseif keyCode == getControl 17
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey17Msg
	return
elseif keyCode == getControl 18
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey18Msg
	return
elseif keyCode == getControl 19
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey19Msg
	return
elseif keyCode == getControl 20
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey20Msg
	return
elseif keyCode == getControl 21
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey21Msg
	return
elseif keyCode == getControl 22
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey22Msg
	return
elseif keyCode == getControl 23
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey23Msg
	return
elseif keyCode == getControl 24
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey24Msg
	return
elseif keyCode == getControl 25
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey25Msg
	return
elseif keyCode == getControl 26
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey26Msg
	return
elseif keyCode == getControl 27
	set COxUtilHotkey.conflict to 1
	set COxUtilHotkey.warningMsg to COxWarningKey27Msg
	return
endif


; Run mod hotkey conflict checkers

set i to 0
set n to listGetCount COxHotkeyCheckerList

Label 99

if i < n
	set func to listGetNthForm COxHotkeyCheckerList i
	if func != 0
		setStage func 1

		; Did mod checker detect a conflict? Then we can stop
		if COxUtilHotkey.conflict == 1
			return
		endif
	endif
	set i to i + 1
	goto 99
endif

}}}